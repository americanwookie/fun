use 5.010001;
use ExtUtils::MakeMaker;
# See lib/ExtUtils/MakeMaker.pm for details of how to influence
# the contents of the Makefile that is written.
WriteMakefile(
    NAME              => 'Mytest4',
    VERSION_FROM      => 'lib/Mytest4.pm', # finds $VERSION
    PREREQ_PM         => {}, # e.g., Module::Name => 1.1
    ($] >= 5.005 ?     ## Add these new keywords supported since 5.005
      (ABSTRACT_FROM  => 'lib/Mytest4.pm', # retrieve abstract from module
       AUTHOR         => 'A. U. Thor <scott@localdomain>') : ()),
    LIBS              => ['-lipset'], # e.g., '-lm'
    DEFINE            => '', # e.g., '-DHAVE_SOMETHING'
    INC               => '-I.', # e.g., '-I. -I/usr/include/other'
	# Un-comment this if you add C files to link with later:
    # OBJECT            => '$(O_FILES)', # link all the C files too
);
if  (eval {require ExtUtils::Constant; 1}) {
  # If you edit these definitions to change the constants used by this module,
  # you will need to use the generated const-c.inc and const-xs.inc
  # files to replace their "fallback" counterparts before distributing your
  # changes.
  my @names = (qw(ASSERT_UNUSED IPSET_ADT_FLAGS IPSET_ATTR_ADT_MAX
		 IPSET_ATTR_CMD_MAX IPSET_ATTR_CREATE_MAX IPSET_ATTR_IPADDR_MAX
		 IPSET_CREATE_FLAGS IPSET_DIM_UMAX IPSET_ERRORBUFLEN
		 IPSET_FLAGS_ALL IPSET_INVALID_ID IPSET_MAXNAMELEN
		 IPSET_OUTBUFLEN IPSET_PROTOCOL NFNETLINK_V0 UNUSED
		 ipset_print_portnum),
              {name=>"IPSET_ADD", macro=>"1"},
              {name=>"IPSET_ADT_MAX", macro=>"1"},
              {name=>"IPSET_ATTR_ADT", macro=>"1"},
              {name=>"IPSET_ATTR_CADT_FLAGS", macro=>"1"},
              {name=>"IPSET_ATTR_CADT_LINENO", macro=>"1"},
              {name=>"IPSET_ATTR_CADT_MAX", macro=>"1"},
              {name=>"IPSET_ATTR_CIDR", macro=>"1"},
              {name=>"IPSET_ATTR_CIDR2", macro=>"1"},
              {name=>"IPSET_ATTR_DATA", macro=>"1"},
              {name=>"IPSET_ATTR_ELEMENTS", macro=>"1"},
              {name=>"IPSET_ATTR_ETHER", macro=>"1"},
              {name=>"IPSET_ATTR_FAMILY", macro=>"1"},
              {name=>"IPSET_ATTR_FLAGS", macro=>"1"},
              {name=>"IPSET_ATTR_GC", macro=>"1"},
              {name=>"IPSET_ATTR_HASHSIZE", macro=>"1"},
              {name=>"IPSET_ATTR_IFACE", macro=>"1"},
              {name=>"IPSET_ATTR_IP", macro=>"1"},
              {name=>"IPSET_ATTR_IP2", macro=>"1"},
              {name=>"IPSET_ATTR_IP2_TO", macro=>"1"},
              {name=>"IPSET_ATTR_IPADDR_IPV4", macro=>"1"},
              {name=>"IPSET_ATTR_IPADDR_IPV6", macro=>"1"},
              {name=>"IPSET_ATTR_IP_FROM", macro=>"1"},
              {name=>"IPSET_ATTR_IP_TO", macro=>"1"},
              {name=>"IPSET_ATTR_LINENO", macro=>"1"},
              {name=>"IPSET_ATTR_MAXELEM", macro=>"1"},
              {name=>"IPSET_ATTR_MEMSIZE", macro=>"1"},
              {name=>"IPSET_ATTR_NAME", macro=>"1"},
              {name=>"IPSET_ATTR_NAMEREF", macro=>"1"},
              {name=>"IPSET_ATTR_NETMASK", macro=>"1"},
              {name=>"IPSET_ATTR_PORT", macro=>"1"},
              {name=>"IPSET_ATTR_PORT_FROM", macro=>"1"},
              {name=>"IPSET_ATTR_PORT_TO", macro=>"1"},
              {name=>"IPSET_ATTR_PROBES", macro=>"1"},
              {name=>"IPSET_ATTR_PROTO", macro=>"1"},
              {name=>"IPSET_ATTR_PROTOCOL", macro=>"1"},
              {name=>"IPSET_ATTR_PROTOCOL_MIN", macro=>"1"},
              {name=>"IPSET_ATTR_REFERENCES", macro=>"1"},
              {name=>"IPSET_ATTR_RESIZE", macro=>"1"},
              {name=>"IPSET_ATTR_REVISION", macro=>"1"},
              {name=>"IPSET_ATTR_REVISION_MIN", macro=>"1"},
              {name=>"IPSET_ATTR_SETNAME", macro=>"1"},
              {name=>"IPSET_ATTR_SETNAME2", macro=>"1"},
              {name=>"IPSET_ATTR_SIZE", macro=>"1"},
              {name=>"IPSET_ATTR_TIMEOUT", macro=>"1"},
              {name=>"IPSET_ATTR_TYPENAME", macro=>"1"},
              {name=>"IPSET_ATTR_UNSPEC", macro=>"1"},
              {name=>"IPSET_CADT_MAX", macro=>"1"},
              {name=>"IPSET_CMD_ADD", macro=>"1"},
              {name=>"IPSET_CMD_COMMIT", macro=>"1"},
              {name=>"IPSET_CMD_CREATE", macro=>"1"},
              {name=>"IPSET_CMD_DEL", macro=>"1"},
              {name=>"IPSET_CMD_DESTROY", macro=>"1"},
              {name=>"IPSET_CMD_FLUSH", macro=>"1"},
              {name=>"IPSET_CMD_HEADER", macro=>"1"},
              {name=>"IPSET_CMD_HELP", macro=>"1"},
              {name=>"IPSET_CMD_LIST", macro=>"1"},
              {name=>"IPSET_CMD_MAX", macro=>"1"},
              {name=>"IPSET_CMD_NONE", macro=>"1"},
              {name=>"IPSET_CMD_PROTOCOL", macro=>"1"},
              {name=>"IPSET_CMD_QUIT", macro=>"1"},
              {name=>"IPSET_CMD_RENAME", macro=>"1"},
              {name=>"IPSET_CMD_RESTORE", macro=>"1"},
              {name=>"IPSET_CMD_SAVE", macro=>"1"},
              {name=>"IPSET_CMD_SWAP", macro=>"1"},
              {name=>"IPSET_CMD_TEST", macro=>"1"},
              {name=>"IPSET_CMD_TYPE", macro=>"1"},
              {name=>"IPSET_CMD_VERSION", macro=>"1"},
              {name=>"IPSET_CREATE", macro=>"1"},
              {name=>"IPSET_DEL", macro=>"1"},
              {name=>"IPSET_DIM_MAX", macro=>"1"},
              {name=>"IPSET_DIM_ONE", macro=>"1"},
              {name=>"IPSET_DIM_ONE_SRC", macro=>"1"},
              {name=>"IPSET_DIM_THREE", macro=>"1"},
              {name=>"IPSET_DIM_THREE_SRC", macro=>"1"},
              {name=>"IPSET_DIM_TWO", macro=>"1"},
              {name=>"IPSET_DIM_TWO_SRC", macro=>"1"},
              {name=>"IPSET_DIM_ZERO", macro=>"1"},
              {name=>"IPSET_ENV_BIT_EXIST", macro=>"1"},
              {name=>"IPSET_ENV_BIT_LIST_HEADER", macro=>"1"},
              {name=>"IPSET_ENV_BIT_LIST_SETNAME", macro=>"1"},
              {name=>"IPSET_ENV_BIT_QUIET", macro=>"1"},
              {name=>"IPSET_ENV_BIT_RESOLVE", macro=>"1"},
              {name=>"IPSET_ENV_BIT_SORTED", macro=>"1"},
              {name=>"IPSET_ENV_EXIST", macro=>"1"},
              {name=>"IPSET_ENV_LIST_HEADER", macro=>"1"},
              {name=>"IPSET_ENV_LIST_SETNAME", macro=>"1"},
              {name=>"IPSET_ENV_QUIET", macro=>"1"},
              {name=>"IPSET_ENV_RESOLVE", macro=>"1"},
              {name=>"IPSET_ENV_SORTED", macro=>"1"},
              {name=>"IPSET_ERROR", macro=>"1"},
              {name=>"IPSET_ERR_BEFORE", macro=>"1"},
              {name=>"IPSET_ERR_BITMAP_RANGE", macro=>"1"},
              {name=>"IPSET_ERR_BITMAP_RANGE_SIZE", macro=>"1"},
              {name=>"IPSET_ERR_BUSY", macro=>"1"},
              {name=>"IPSET_ERR_EXIST", macro=>"1"},
              {name=>"IPSET_ERR_EXIST_SETNAME2", macro=>"1"},
              {name=>"IPSET_ERR_FIND_TYPE", macro=>"1"},
              {name=>"IPSET_ERR_HASH_ELEM", macro=>"1"},
              {name=>"IPSET_ERR_HASH_FULL", macro=>"1"},
              {name=>"IPSET_ERR_HASH_RANGE", macro=>"1"},
              {name=>"IPSET_ERR_HASH_RANGE_UNSUPPORTED", macro=>"1"},
              {name=>"IPSET_ERR_INVALID_CIDR", macro=>"1"},
              {name=>"IPSET_ERR_INVALID_FAMILY", macro=>"1"},
              {name=>"IPSET_ERR_INVALID_NETMASK", macro=>"1"},
              {name=>"IPSET_ERR_INVALID_PROTO", macro=>"1"},
              {name=>"IPSET_ERR_IPADDR_IPV4", macro=>"1"},
              {name=>"IPSET_ERR_IPADDR_IPV6", macro=>"1"},
              {name=>"IPSET_ERR_LIST_FULL", macro=>"1"},
              {name=>"IPSET_ERR_LOOP", macro=>"1"},
              {name=>"IPSET_ERR_MAX_SETS", macro=>"1"},
              {name=>"IPSET_ERR_MISSING_PROTO", macro=>"1"},
              {name=>"IPSET_ERR_NAME", macro=>"1"},
              {name=>"IPSET_ERR_NAMEREF", macro=>"1"},
              {name=>"IPSET_ERR_PRIVATE", macro=>"1"},
              {name=>"IPSET_ERR_PROTOCOL", macro=>"1"},
              {name=>"IPSET_ERR_REFERENCED", macro=>"1"},
              {name=>"IPSET_ERR_REF_EXIST", macro=>"1"},
              {name=>"IPSET_ERR_TIMEOUT", macro=>"1"},
              {name=>"IPSET_ERR_TYPE_MISMATCH", macro=>"1"},
              {name=>"IPSET_ERR_TYPE_SPECIFIC", macro=>"1"},
              {name=>"IPSET_FLAG_BEFORE", macro=>"1"},
              {name=>"IPSET_FLAG_BIT_BEFORE", macro=>"1"},
              {name=>"IPSET_FLAG_BIT_EXIST", macro=>"1"},
              {name=>"IPSET_FLAG_BIT_LIST_HEADER", macro=>"1"},
              {name=>"IPSET_FLAG_BIT_LIST_SETNAME", macro=>"1"},
              {name=>"IPSET_FLAG_BIT_NOMATCH", macro=>"1"},
              {name=>"IPSET_FLAG_BIT_PHYSDEV", macro=>"1"},
              {name=>"IPSET_FLAG_CADT_MAX", macro=>"1"},
              {name=>"IPSET_FLAG_CMD_MAX", macro=>"1"},
              {name=>"IPSET_FLAG_EXIST", macro=>"1"},
              {name=>"IPSET_FLAG_LIST_HEADER", macro=>"1"},
              {name=>"IPSET_FLAG_LIST_SETNAME", macro=>"1"},
              {name=>"IPSET_FLAG_NOMATCH", macro=>"1"},
              {name=>"IPSET_FLAG_PHYSDEV", macro=>"1"},
              {name=>"IPSET_INV_MATCH", macro=>"1"},
              {name=>"IPSET_KERNEL_CHECK_NEEDED", macro=>"1"},
              {name=>"IPSET_KERNEL_MISMATCH", macro=>"1"},
              {name=>"IPSET_KERNEL_OK", macro=>"1"},
              {name=>"IPSET_LIST_NONE", macro=>"1"},
              {name=>"IPSET_LIST_PLAIN", macro=>"1"},
              {name=>"IPSET_LIST_SAVE", macro=>"1"},
              {name=>"IPSET_LIST_XML", macro=>"1"},
              {name=>"IPSET_MANDATORY_ARG", macro=>"1"},
              {name=>"IPSET_MANDATORY_ARG2", macro=>"1"},
              {name=>"IPSET_MSG_MAX", macro=>"1"},
              {name=>"IPSET_NO_ARG", macro=>"1"},
              {name=>"IPSET_OPTIONAL_ARG", macro=>"1"},
              {name=>"IPSET_OPT_BEFORE", macro=>"1"},
              {name=>"IPSET_OPT_CADT_FLAGS", macro=>"1"},
              {name=>"IPSET_OPT_CIDR", macro=>"1"},
              {name=>"IPSET_OPT_CIDR2", macro=>"1"},
              {name=>"IPSET_OPT_ELEM", macro=>"1"},
              {name=>"IPSET_OPT_ELEMENTS", macro=>"1"},
              {name=>"IPSET_OPT_ETHER", macro=>"1"},
              {name=>"IPSET_OPT_EXIST", macro=>"1"},
              {name=>"IPSET_OPT_FAMILY", macro=>"1"},
              {name=>"IPSET_OPT_FLAGS", macro=>"1"},
              {name=>"IPSET_OPT_GC", macro=>"1"},
              {name=>"IPSET_OPT_HASHSIZE", macro=>"1"},
              {name=>"IPSET_OPT_IFACE", macro=>"1"},
              {name=>"IPSET_OPT_IP", macro=>"1"},
              {name=>"IPSET_OPT_IP2", macro=>"1"},
              {name=>"IPSET_OPT_IP2_TO", macro=>"1"},
              {name=>"IPSET_OPT_IP_FROM", macro=>"1"},
              {name=>"IPSET_OPT_IP_TO", macro=>"1"},
              {name=>"IPSET_OPT_LINENO", macro=>"1"},
              {name=>"IPSET_OPT_MAX", macro=>"1"},
              {name=>"IPSET_OPT_MAXELEM", macro=>"1"},
              {name=>"IPSET_OPT_MEMSIZE", macro=>"1"},
              {name=>"IPSET_OPT_NAME", macro=>"1"},
              {name=>"IPSET_OPT_NAMEREF", macro=>"1"},
              {name=>"IPSET_OPT_NETMASK", macro=>"1"},
              {name=>"IPSET_OPT_NOMATCH", macro=>"1"},
              {name=>"IPSET_OPT_NONE", macro=>"1"},
              {name=>"IPSET_OPT_PHYSDEV", macro=>"1"},
              {name=>"IPSET_OPT_PORT", macro=>"1"},
              {name=>"IPSET_OPT_PORT_FROM", macro=>"1"},
              {name=>"IPSET_OPT_PORT_TO", macro=>"1"},
              {name=>"IPSET_OPT_PROBES", macro=>"1"},
              {name=>"IPSET_OPT_PROTO", macro=>"1"},
              {name=>"IPSET_OPT_REFERENCES", macro=>"1"},
              {name=>"IPSET_OPT_RESIZE", macro=>"1"},
              {name=>"IPSET_OPT_REVISION", macro=>"1"},
              {name=>"IPSET_OPT_REVISION_MIN", macro=>"1"},
              {name=>"IPSET_OPT_SETNAME2", macro=>"1"},
              {name=>"IPSET_OPT_SIZE", macro=>"1"},
              {name=>"IPSET_OPT_TIMEOUT", macro=>"1"},
              {name=>"IPSET_OPT_TYPE", macro=>"1"},
              {name=>"IPSET_OPT_TYPENAME", macro=>"1"},
              {name=>"IPSET_SETNAME", macro=>"1"},
              {name=>"IPSET_TEST", macro=>"1"},
              {name=>"IPSET_WARNING", macro=>"1"},
              {name=>"NFPROTO_ARP", macro=>"1"},
              {name=>"NFPROTO_BRIDGE", macro=>"1"},
              {name=>"NFPROTO_DECNET", macro=>"1"},
              {name=>"NFPROTO_IPSET_IPV46", macro=>"1"},
              {name=>"NFPROTO_IPV4", macro=>"1"},
              {name=>"NFPROTO_IPV6", macro=>"1"},
              {name=>"NFPROTO_NUMPROTO", macro=>"1"},
              {name=>"NFPROTO_UNSPEC", macro=>"1"},
              {name=>"__IPSET_ATTR_ADT_MAX", macro=>"1"},
              {name=>"__IPSET_ATTR_CMD_MAX", macro=>"1"},
              {name=>"__IPSET_ATTR_CREATE_MAX", macro=>"1"},
              {name=>"__IPSET_ATTR_IPADDR_MAX", macro=>"1"});
  ExtUtils::Constant::WriteConstants(
                                     NAME         => 'Mytest4',
                                     NAMES        => \@names,
                                     DEFAULT_TYPE => 'IV',
                                     C_FILE       => 'const-c.inc',
                                     XS_FILE      => 'const-xs.inc',
                                  );

}
else {
  use File::Copy;
  use File::Spec;
  foreach my $file ('const-c.inc', 'const-xs.inc') {
    my $fallback = File::Spec->catfile('fallback', $file);
    copy ($fallback, $file) or die "Can't copy $fallback to $file: $!";
  }
}
